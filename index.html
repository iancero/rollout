<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>What the Package Does (One Line, Title Case) • rollout</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta name="description" content="What the package does (one paragraph).">
<meta property="og:description" content="What the package does (one paragraph).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rollout</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iancero/rollout/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rollout">rollout<a class="anchor" aria-label="anchor" href="#rollout"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="basic-example">Basic Example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h2>
<p>We begin with a basic example of the most widely known rollout trial format: a stepped wedge trial. In such a trial, sites are randomly assigned to cohorts. Then, these cohorts are assigned to receive the intervention beginning at different times. Data are recorded for the duration of the study, both before (baseline condition) and after the initiation of an intervention condition.</p>
<p>In <code>rollout</code>, simulating such a trial begins with a matrix specification of the cohorts and their transition points, like so.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.2     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span></span>
<span><span class="va">rollout_schedule</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">cohort</span>, <span class="op">~</span><span class="va">site</span>, <span class="op">~</span><span class="va">t1</span>,    <span class="op">~</span><span class="va">t2</span>,    <span class="op">~</span><span class="va">t3</span>,    <span class="op">~</span><span class="va">t4</span>,    <span class="op">~</span><span class="va">t5</span>,</span>
<span>  <span class="st">"c1"</span>,    <span class="st">"001"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c1"</span>,    <span class="st">"002"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c2"</span>,    <span class="st">"003"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c2"</span>,    <span class="st">"004"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c3"</span>,    <span class="st">"005"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c3"</span>,    <span class="st">"006"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c4"</span>,    <span class="st">"007"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span>,</span>
<span>  <span class="st">"c4"</span>,    <span class="st">"008"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"bsln"</span>, <span class="st">"intv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This allows the user maximum control over what can become a complex process of scheduling, responding to real world pragmatic constraints. But in this format, it is not yet convenient for simulation, so <code>rollout</code> offers the utility function <code>pivot_schedule_longer()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iancero/rollout" class="external-link">rollout</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">rollout_design</span> <span class="op">&lt;-</span> <span class="va">rollout_schedule</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_schedule_longer</span><span class="op">(</span><span class="va">t1</span><span class="op">:</span><span class="va">t5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 40 × 4</span></span>
<span><span class="co">#&gt;    cohort site  chron_time condition</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span><span class="co">#&gt;  1 c1     001            1 bsln     </span></span>
<span><span class="co">#&gt;  2 c1     001            2 intv     </span></span>
<span><span class="co">#&gt;  3 c1     001            3 intv     </span></span>
<span><span class="co">#&gt;  4 c1     001            4 intv     </span></span>
<span><span class="co">#&gt;  5 c1     001            5 intv     </span></span>
<span><span class="co">#&gt;  6 c1     002            1 bsln     </span></span>
<span><span class="co">#&gt;  7 c1     002            2 intv     </span></span>
<span><span class="co">#&gt;  8 c1     002            3 intv     </span></span>
<span><span class="co">#&gt;  9 c1     002            4 intv     </span></span>
<span><span class="co">#&gt; 10 c1     002            5 intv     </span></span>
<span><span class="co">#&gt; # ℹ 30 more rows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rollout_design</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   cohort site  chron_time condition local_time</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 c1     001            1 bsln               0</span></span>
<span><span class="co">#&gt; 2 c1     001            2 intv               0</span></span>
<span><span class="co">#&gt; 3 c1     001            3 intv               1</span></span>
<span><span class="co">#&gt; 4 c1     001            4 intv               2</span></span>
<span><span class="co">#&gt; 5 c1     001            5 intv               3</span></span>
<span><span class="co">#&gt; 6 c1     002            1 bsln               1</span></span></code></pre></div>
<p>In addition to performing a wide-to-long pivot on our schedule, this function has also computed two time columns: chron_time and local_time (0-indexed, to make cohort-specific effects easier to program). It has also constructed a condition column of all the conditions.</p>
<p>Now that the data are in this format, the user is prepared to incoporate any site-level background information they might have. For example, as part of pre-trial assessment and coordination with the study sites, a user might have access to site-level information, like the self-reported readiness to receive the intervention at the site, as well as the relative population of observational units at the site (e.g., classes per timepoint, servicemembers per class). For simplicity, we imagine some of these data below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_info</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">site</span>, <span class="op">~</span><span class="va">admin_readiness</span>, <span class="op">~</span><span class="va">classes_per_time</span>, <span class="op">~</span><span class="va">members_per_class</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">6</span>,                <span class="fl">11</span>,                <span class="fl">23</span>,</span>
<span>  <span class="st">"002"</span>,    <span class="fl">7</span>,                <span class="fl">15</span>,                <span class="fl">25</span>,</span>
<span>  <span class="st">"003"</span>,    <span class="fl">6</span>,                <span class="fl">11</span>,                <span class="fl">22</span>,</span>
<span>  <span class="st">"004"</span>,    <span class="fl">9</span>,                <span class="fl">12</span>,                <span class="fl">16</span>,</span>
<span>  <span class="st">"005"</span>,    <span class="fl">7</span>,                <span class="fl">11</span>,                <span class="fl">24</span>,</span>
<span>  <span class="st">"006"</span>,    <span class="fl">2</span>,                <span class="fl">9</span>,                 <span class="fl">22</span>,</span>
<span>  <span class="st">"007"</span>,    <span class="fl">2</span>,                <span class="fl">9</span>,                 <span class="fl">16</span>,</span>
<span>  <span class="st">"008"</span>,    <span class="fl">7</span>,                <span class="fl">14</span>,                <span class="fl">25</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>And then link them to our design dataframe. We can do this with a simple left_join(), but we are stuck with the fact that two of our columns are actually counts of observational units (in fact, nested units), which will need to be expanded too. Anticipating this is a common situation, <code>rollout</code> has its own helper function for joining and expanding such site-related information:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rollout_design</span> <span class="op">&lt;-</span> <span class="va">rollout_design</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">join_info</span><span class="op">(</span></span>
<span>    <span class="va">site_info</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>    uncount_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classes_per_time"</span>, <span class="st">"members_per_class"</span><span class="op">)</span>,</span>
<span>    .ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="st">"member"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>With our design fully expanded, we now need to initialize several replicates of this same dataset for later simulation of data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">rollout_design</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">initialize_replicates</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulated_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span><span class="co">#&gt;   sample_id cohort site  chron_time condition local_time admin_readiness class</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1         1 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 2         2 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 3         3 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 4         4 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 5         5 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 6         6 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: member &lt;int&gt;</span></span></code></pre></div>
<div class="section level3">
<h3 id="simulating-effects">Simulating effects<a class="anchor" aria-label="anchor" href="#simulating-effects"></a>
</h3>
<div class="section level4">
<h4 id="fixed-effects">Fixed effects<a class="anchor" aria-label="anchor" href="#fixed-effects"></a>
</h4>
<p>To start, let’s add an intervention effect that gives an immediate boost in individual-level outcomes, followed by slow further improvement. We’ll also add an effect representing a potential confound - a global improvement in the overall population (what an economist might call a “secular trend”).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">simulated_trials</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_fixed_effect</span><span class="op">(</span></span>
<span>    condition <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">condition</span> <span class="op">==</span> <span class="st">"bsln"</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">condition</span> <span class="op">==</span> <span class="st">"intv"</span> <span class="op">~</span> <span class="fl">.50</span> <span class="op">+</span> <span class="fl">.10</span><span class="op">*</span><span class="va">local_time</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">add_fixed_effect</span><span class="op">(</span></span>
<span>    popwide_decline <span class="op">=</span> <span class="fl">.10</span><span class="op">*</span><span class="va">chron_time</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulated_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   sample_id cohort site  chron_time condition local_time admin_readiness class</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1         1 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 2         2 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 3         3 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 4         4 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 5         5 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 6         6 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: member &lt;int&gt;, .condition &lt;dbl&gt;, .popwide_decline &lt;dbl&gt;</span></span></code></pre></div>
<p>Underneath the hood, <code>add_fixed_effect()</code> is a thin wrapper around <code>mutate()</code> that does a few things: first, it limits the number of variables that can be created in a single call to exactly one named argument. This admittedly creates some redundant work for the user, who now has to call <code>add_fixed_effect()</code> multiple times, but comes with the advantage of forcing more readable code for these designs. All effect generation functions (more on these below) in <code>rollout</code> follow this convention. Second, they pre-pend all effect variables with a “<code>.</code>” to make it obvious which variables in the <code>simulated_trials</code> dataframe are data and which are effects that will eventually be used in the generation of an outcome variable. In this way, the user can focus on data that they want the effect to be associated with, rather than keeping variable names straight. It also facilitates the creation of an outcome creation function, which can automatically search for effects in <code>simulated_trials</code> and aggregate them into an outcome.</p>
</div>
<div class="section level4">
<h4 id="random-effects">Random effects<a class="anchor" aria-label="anchor" href="#random-effects"></a>
</h4>
<p>Random effects are simulated similarly to fixed effects, except that it is sometimes important to take nesting structure into account. For example, to create a class-level random intercept, we need to specify that classes are nested within sites and cohorts, like so:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">simulated_trials</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_random_effect</span><span class="op">(</span></span>
<span>    instructor_experience <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">.30</span><span class="op">)</span>,</span>
<span>    .nesting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cohort"</span>, <span class="st">"site"</span>, <span class="st">"class"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulated_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   sample_id cohort site  chron_time condition local_time admin_readiness class</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1         1 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 2         2 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 3         3 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 4         4 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 5         5 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 6         6 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: member &lt;int&gt;, .condition &lt;dbl&gt;, .popwide_decline &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   .instructor_experience &lt;dbl&gt;</span></span></code></pre></div>
<p>As another example in this trial, it might also be important for even instances of a given class to share variance because they have overlapping students.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">simulated_trials</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_random_effect</span><span class="op">(</span></span>
<span>    student_cohesion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">.20</span><span class="op">)</span>,</span>
<span>    .nesting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cohort"</span>, <span class="st">"site"</span>, <span class="st">"class"</span>, <span class="st">"local_time"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulated_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 13</span></span>
<span><span class="co">#&gt;   sample_id cohort site  chron_time condition local_time admin_readiness class</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1         1 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 2         2 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 3         3 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 4         4 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 5         5 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 6         6 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; # ℹ 5 more variables: member &lt;int&gt;, .condition &lt;dbl&gt;, .popwide_decline &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   .instructor_experience &lt;dbl&gt;, .student_cohesion &lt;dbl&gt;</span></span></code></pre></div>
<p>Again, underneath the hood, this is a wrapper to some dplyr functions applying a groupby-mutate-ungroup pattern. However, it is slightly more complicated because it will intercept the existing group structure of the incoming dataframe (e.g., if group_by has been called before), store it, calculate the random effect according to the nesting structure (if specified), then regroup the dataframe exactly as it was before the function. If no nesting structure is specified, this function will simply rely on the grouping structure given to it in the incoming dataframe.</p>
</div>
<div class="section level4">
<h4 id="error-variance">Error variance<a class="anchor" aria-label="anchor" href="#error-variance"></a>
</h4>
<p>Finally, the simplest effect to add is random error, which is simple enough to specify with just a variance.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">simulated_trials</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_error</span><span class="op">(</span>variance <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="outcome-variables">Outcome variables<a class="anchor" aria-label="anchor" href="#outcome-variables"></a>
</h3>
<p>We can add three different types of outcome variables: linear, binary (logistic), and Poisson. Unlike the effects above, these at NOT automatically prepended with “.” because they are observed values - rather than effects, they are data. Additionally, both the binary and Poisson functions return multiple columns, including the final observed output column (i.e., the simulated binary outcome) and the associated input columns that were involved in producing it (i.e., y_linear, y_prob).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_trials</span> <span class="op">&lt;-</span> <span class="va">simulated_trials</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_binary_outcome</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulated_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 17</span></span>
<span><span class="co">#&gt;   sample_id cohort site  chron_time condition local_time admin_readiness class</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1         1 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 2         2 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 3         3 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 4         4 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 5         5 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; 6         6 c1     001            1 bsln               0               6     1</span></span>
<span><span class="co">#&gt; # ℹ 9 more variables: member &lt;int&gt;, .condition &lt;dbl&gt;, .popwide_decline &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   .instructor_experience &lt;dbl&gt;, .student_cohesion &lt;dbl&gt;, .error &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   y_linear &lt;dbl&gt;, y_prob &lt;dbl&gt;, y_bin &lt;int&gt;</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/iancero/rollout/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/iancero/rollout/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rollout</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>First Last <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=rollout" class="external-link"><img src="https://www.r-pkg.org/badges/version/rollout" alt="CRAN status"></a></li>
<li><a href="https://github.com/iancero/rollout/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/iancero/rollout/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/iancero/rollout" class="external-link"><img src="https://codecov.io/gh/iancero/rollout/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
